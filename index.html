<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DuMonde Lab - Ethical Narratives for a Connected World</title>
    <script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-firestore.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-auth.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #B22234;
            --dark: #1a1a1a;
            --gray-light: #f5f5f5;
            --gray: #999;
            --text: #333;
            --white: #fff;
            --accent: #2563eb;
        }

        html {
            scroll-behavior: smooth;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
            line-height: 1.6;
            color: var(--text);
            background: var(--white);
        }

        /* Header & Navigation */
        header {
            background: var(--white);
            border-bottom: 1px solid #eee;
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }

        nav {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            height: 70px;
        }

        .logo {
            font-size: 24px;
            font-weight: 700;
            color: var(--primary);
            display: flex;
            gap: 8px;
            cursor: pointer;
        }

        .logo span:last-child {
            color: var(--dark);
        }

        .nav-menu {
            display: flex;
            gap: 30px;
            align-items: center;
            list-style: none;
        }

        .nav-menu a {
            text-decoration: none;
            color: var(--text);
            font-weight: 500;
            font-size: 14px;
            transition: color 0.3s;
            cursor: pointer;
        }

        .nav-menu a:hover {
            color: var(--primary);
        }

        .lang-selector {
            font-size: 13px;
            color: var(--gray);
            cursor: pointer;
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 4px;
            transition: all 0.3s;
            display: flex;
            gap: 8px;
        }

        .lang-option {
            cursor: pointer;
            font-weight: 600;
        }

        .lang-option.active {
            color: var(--primary);
        }

        .lang-selector:hover {
            border-color: var(--primary);
            color: var(--primary);
        }

        .admin-btn {
            font-size: 11px;
            padding: 6px 10px;
            background: #f0f0f0;
            border: 1px solid #ddd;
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .admin-btn:hover {
            background: var(--primary);
            color: var(--white);
            border-color: var(--primary);
        }

        .hamburger {
            display: none;
            flex-direction: column;
            gap: 5px;
            cursor: pointer;
        }

        .hamburger span {
            width: 25px;
            height: 3px;
            background: var(--text);
            border-radius: 2px;
            transition: all 0.3s;
        }

        /* Hero Section */
        .hero {
            background: linear-gradient(135deg, #f5f5f5 0%, #efefef 100%);
            padding: 120px 20px;
            text-align: center;
        }

        .hero-content {
            max-width: 800px;
            margin: 0 auto;
        }

        .hero h1 {
            font-size: 52px;
            margin-bottom: 20px;
            color: var(--dark);
            font-weight: 700;
        }

        .hero-subtitle {
            font-size: 18px;
            color: var(--gray);
            margin-bottom: 30px;
        }

        .btn-group {
            display: flex;
            gap: 15px;
            justify-content: center;
            flex-wrap: wrap;
        }

        button {
            padding: 12px 28px;
            border: none;
            border-radius: 6px;
            font-size: 15px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }

        .btn-primary {
            background: var(--primary);
            color: var(--white);
        }

        .btn-primary:hover {
            background: #8b1a28;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(178, 34, 52, 0.3);
        }

        .btn-secondary {
            background: transparent;
            border: 2px solid var(--text);
            color: var(--text);
        }

        .btn-secondary:hover {
            border-color: var(--primary);
            color: var(--primary);
        }

        .btn-outline {
            background: transparent;
            border: 1px solid #ddd;
            color: var(--text);
        }

        .btn-outline:hover {
            border-color: var(--primary);
            color: var(--primary);
        }

        .btn-sm {
            padding: 8px 16px;
            font-size: 13px;
        }

        .btn-sm.delete {
            background: #dc2626;
            color: var(--white);
        }

        .btn-sm.delete:hover {
            background: #991b1b;
        }

        /* Sections */
        .section {
            display: none;
        }

        .section.active {
            display: block;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 60px 20px;
        }

        .section-title {
            font-size: 36px;
            margin-bottom: 40px;
            text-align: center;
            color: var(--dark);
            font-weight: 700;
        }

        .section-subtitle {
            font-size: 16px;
            color: var(--gray);
            margin-bottom: 30px;
            line-height: 1.8;
        }

        /* What We Do */
        .what-we-do {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 30px;
            margin-top: 50px;
        }

        .card {
            background: var(--white);
            border: 1px solid #eee;
            border-radius: 10px;
            padding: 30px;
            transition: all 0.3s;
        }

        .card:hover {
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            border-color: var(--primary);
            transform: translateY(-5px);
        }

        .card h3 {
            font-size: 20px;
            margin-bottom: 15px;
            color: var(--dark);
        }

        .card p {
            color: var(--gray);
            font-size: 14px;
            line-height: 1.8;
        }

        /* Pillars */
        .pillars {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 20px;
            margin-top: 40px;
        }

        .pillar {
            background: linear-gradient(135deg, var(--primary) 0%, #8b1a28 100%);
            color: var(--white);
            padding: 30px;
            border-radius: 10px;
            text-align: center;
            transition: all 0.3s;
        }

        .pillar:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(178, 34, 52, 0.3);
        }

        .pillar h4 {
            font-size: 18px;
            margin-bottom: 10px;
        }

        /* Articles Grid */
        .articles-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 30px;
            margin-top: 40px;
        }

        .article-card {
            border: 1px solid #eee;
            border-radius: 10px;
            overflow: hidden;
            transition: all 0.3s;
            cursor: pointer;
        }

        .article-card:hover {
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            transform: translateY(-5px);
        }

        .article-card-image {
            width: 100%;
            height: 180px;
            background: linear-gradient(135deg, #f5f5f5 0%, #efefef 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--gray);
            font-size: 12px;
        }

        .article-card-content {
            padding: 20px;
        }

        .article-meta {
            display: flex;
            justify-content: space-between;
            font-size: 12px;
            color: var(--gray);
            margin-bottom: 10px;
        }

        .article-category {
            display: inline-block;
            background: var(--primary);
            color: var(--white);
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 11px;
            margin-bottom: 10px;
        }

        .article-card h4 {
            font-size: 16px;
            margin-bottom: 8px;
            color: var(--dark);
        }

        .article-excerpt {
            color: var(--gray);
            font-size: 13px;
            line-height: 1.6;
            margin-bottom: 15px;
        }

        /* Filters */
        .filters {
            display: flex;
            gap: 20px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }

        .filter-group {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }

        .filter-group label {
            font-size: 13px;
            font-weight: 600;
            color: var(--text);
        }

        select, input, textarea {
            padding: 10px 12px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 14px;
            background: var(--white);
            font-family: inherit;
        }

        input:focus, textarea:focus, select:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(178, 34, 52, 0.1);
        }

        /* Detail Views */
        .detail-view {
            display: none;
        }

        .detail-view.active {
            display: block;
        }

        .detail-header {
            background: var(--gray-light);
            padding: 40px 20px;
            margin-bottom: 40px;
        }

        .detail-header h1 {
            max-width: 1200px;
            margin: 0 auto;
            font-size: 36px;
            color: var(--dark);
            margin-bottom: 15px;
        }

        .detail-meta {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            gap: 20px;
            font-size: 14px;
            color: var(--gray);
            flex-wrap: wrap;
        }

        .detail-content {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        .detail-body {
            line-height: 1.9;
            color: var(--text);
            margin-bottom: 40px;
            white-space: pre-wrap;
        }

        .detail-body p {
            margin-bottom: 15px;
        }

        .detail-tags {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-bottom: 30px;
        }

        .tag {
            background: #f0f0f0;
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 12px;
            color: var(--text);
        }

        .detail-actions {
            display: flex;
            gap: 15px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }

        /* Forms */
        form {
            background: var(--gray-light);
            padding: 30px;
            border-radius: 10px;
            margin-top: 30px;
            max-width: 600px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            font-size: 14px;
            color: var(--text);
        }

        .form-group input,
        .form-group textarea,
        .form-group select {
            width: 100%;
        }

        .form-group textarea {
            resize: vertical;
            min-height: 120px;
        }

        /* Plans */
        .plans {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 30px;
            margin-top: 40px;
        }

        .plan {
            border: 2px solid #eee;
            border-radius: 10px;
            padding: 30px;
            text-align: center;
            transition: all 0.3s;
        }

        .plan:hover {
            border-color: var(--primary);
            box-shadow: 0 10px 30px rgba(178, 34, 52, 0.2);
            transform: translateY(-5px);
        }

        .plan h3 {
            font-size: 22px;
            margin-bottom: 10px;
            color: var(--dark);
        }

        .plan-features {
            text-align: left;
            margin: 20px 0;
            color: var(--gray);
            font-size: 14px;
        }

        .plan-features li {
            list-style: none;
            padding: 8px 0;
            border-bottom: 1px solid #eee;
        }

        .plan-features li:last-child {
            border-bottom: none;
        }

        /* Forum */
        .topic-card {
            background: var(--gray-light);
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 15px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .topic-card:hover {
            background: #e8e8e8;
            transform: translateX(5px);
        }

        .topic-header {
            display: flex;
            justify-content: space-between;
            align-items: start;
            margin-bottom: 10px;
        }

        .topic-stats {
            display: flex;
            gap: 20px;
            font-size: 13px;
            color: var(--gray);
        }

        .replies-list {
            margin-top: 30px;
            border-left: 3px solid var(--primary);
            padding-left: 20px;
        }

        .reply {
            background: var(--gray-light);
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 15px;
        }

        .reply-author {
            font-weight: 600;
            margin-bottom: 8px;
            color: var(--dark);
        }

        .reply-date {
            font-size: 12px;
            color: var(--gray);
            margin-bottom: 10px;
        }

        .reply-content {
            color: var(--text);
            line-height: 1.6;
            margin-bottom: 10px;
        }

        .reply-actions {
            display: flex;
            gap: 15px;
            font-size: 13px;
        }

        .like-btn {
            background: none;
            border: none;
            color: var(--gray);
            cursor: pointer;
            padding: 0;
            font-weight: 600;
        }

        .like-btn.liked {
            color: var(--primary);
        }

        /* Library Table */
        .library-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 30px;
        }

        .library-table th {
            background: var(--gray-light);
            padding: 15px;
            text-align: left;
            font-weight: 600;
            border-bottom: 2px solid #ddd;
        }

        .library-table td {
            padding: 15px;
            border-bottom: 1px solid #eee;
        }

        .library-table tr:hover {
            background: #fafafa;
        }

        /* Notifications */
        .notification {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: var(--primary);
            color: var(--white);
            padding: 16px 24px;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            animation: slideIn 0.3s ease-out;
            max-width: 350px;
            z-index: 1000;
        }

        .notification.error {
            background: #dc2626;
        }

        .notification.success {
            background: #16a34a;
        }

        .notification.info {
            background: #2563eb;
        }

        @keyframes slideIn {
            from {
                transform: translateX(400px);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        @keyframes slideOut {
            from {
                transform: translateX(0);
                opacity: 1;
            }
            to {
                transform: translateX(400px);
                opacity: 0;
            }
        }

        .notification.removing {
            animation: slideOut 0.3s ease-in;
        }

        /* Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.5);
            z-index: 500;
            align-items: center;
            justify-content: center;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: var(--white);
            padding: 40px;
            border-radius: 10px;
            max-width: 600px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
            position: relative;
        }

        .modal-close {
            position: absolute;
            top: 20px;
            right: 20px;
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: var(--gray);
        }

        .modal-close:hover {
            color: var(--text);
        }

        /* Admin Panel */
        .admin-panel {
            background: var(--gray-light);
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 30px;
        }

        .admin-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            border-bottom: 2px solid #ddd;
        }

        .admin-tab {
            padding: 10px 20px;
            background: none;
            border: none;
            cursor: pointer;
            font-weight: 600;
            color: var(--gray);
            transition: all 0.3s;
            border-bottom: 3px solid transparent;
            margin-bottom: -2px;
        }

        .admin-tab.active {
            color: var(--primary);
            border-bottom-color: var(--primary);
        }

        .admin-content {
            display: none;
        }

        .admin-content.active {
            display: block;
        }

        .admin-list {
            margin-top: 20px;
        }

        .admin-item {
            background: var(--white);
            padding: 15px;
            border-radius: 6px;
            margin-bottom: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .admin-item-info h4 {
            margin-bottom: 5px;
            color: var(--dark);
        }

        .admin-item-info p {
            font-size: 12px;
            color: var(--gray);
        }

        /* Loading */
        .loading {
            opacity: 0.6;
            pointer-events: none;
        }

        .spinner {
            border: 3px solid #f3f3f3;
            border-top: 3px solid var(--primary);
            border-radius: 50%;
            width: 20px;
            height: 20px;
            animation: spin 1s linear infinite;
            display: inline-block;
            margin-right: 10px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Footer */
        footer {
            background: var(--dark);
            color: var(--white);
            padding: 40px 20px;
            text-align: center;
            margin-top: 60px;
        }

        .footer-content {
            max-width: 1200px;
            margin: 0 auto;
        }

        .footer-content p {
            margin-bottom: 10px;
            font-size: 14px;
        }

        .footer-link {
            color: var(--primary);
            text-decoration: none;
        }

        .footer-link:hover {
            text-decoration: underline;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .hamburger {
                display: flex;
            }

            .nav-menu {
                display: none;
                position: absolute;
                top: 70px;
                left: 0;
                right: 0;
                background: var(--white);
                flex-direction: column;
                gap: 0;
                border-bottom: 1px solid #eee;
            }

            .nav-menu.active {
                display: flex;
            }

            .nav-menu a {
                display: block;
                padding: 15px 20px;
                border-bottom: 1px solid #eee;
            }

            .hero h1 {
                font-size: 36px;
            }

            .what-we-do,
            .pillars,
            .articles-grid,
            .plans {
                grid-template-columns: 1fr;
            }

            .pillars {
                grid-template-columns: repeat(2, 1fr);
            }

            .section-title {
                font-size: 28px;
            }

            .btn-group {
                flex-direction: column;
            }

            button {
                width: 100%;
            }

            .detail-actions {
                flex-direction: column;
            }

            .filters {
                flex-direction: column;
            }

            .filter-group {
                width: 100%;
            }

            select {
                width: 100%;
            }

            .topic-header {
                flex-direction: column;
            }

            .admin-item {
                flex-direction: column;
                align-items: flex-start;
            }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header>
        <nav>
            <div class="logo" onclick="showSection('home')">
                <span>DuMonde</span>
                <span>Lab</span>
            </div>
            <ul class="nav-menu">
                <li><a onclick="showSection('home')">Home</a></li>
                <li><a onclick="showSection('about')">About</a></li>
                <li><a onclick="showSection('research')">Research</a></li>
                <li><a onclick="showSection('analytics')">Analytics</a></li>
                <li><a onclick="showSection('community')">Community</a></li>
                <li><a onclick="showSection('services')">Services</a></li>
                <li><a onclick="showSection('blog')">Blog</a></li>
                <li><a onclick="showSection('library')">Library</a></li>
                <li><a onclick="showSection('forum')">Forum</a></li>
                <li><a onclick="showSection('subscribe')">Subscribe</a></li>
                <li><a onclick="showSection('contact')">Contact</a></li>
                <li class="lang-selector">
                    <span class="lang-option active" onclick="changeLanguage('en')">EN</span>
                    <span>·</span>
                    <span class="lang-option" onclick="changeLanguage('fr')">FR</span>
                    <span>·</span>
                    <span class="lang-option" onclick="changeLanguage('es')">ES</span>
                </li>
                <li><button class="admin-btn" onclick="toggleAdminLogin()">Admin</button></li>
            </ul>
            <div class="hamburger" onclick="toggleMenu()">
                <span></span>
                <span></span>
                <span></span>
            </div>
        </nav>
    </header>

    <!-- Admin Login Modal -->
    <div id="adminLoginModal" class="modal">
        <div class="modal-content">
            <button class="modal-close" onclick="closeAdminLogin()">&times;</button>
            <h2 data-i18n="adminLoginTitle">Admin Login</h2>
            <form onsubmit="handleAdminLogin(event)">
                <div class="form-group">
                    <label>Email</label>
                    <input type="email" id="adminEmail" required>
                </div>
                <div class="form-group">
                    <label>Password</label>
                    <input type="password" id="adminPassword" required>
                </div>
                <button type="submit" class="btn-primary" style="width: 100%;">Login</button>
            </form>
        </div>
    </div>

    <!-- Admin Panel -->
    <div id="adminPanel" class="section">
        <div class="container">
            <h1 class="section-title">Admin Panel</h1>
            <button class="btn-outline btn-sm" onclick="handleAdminLogout()" style="margin-bottom: 20px;">Logout</button>

            <div class="admin-panel">
                <div class="admin-tabs">
                    <button class="admin-tab active" onclick="switchAdminTab('articles')">Articles</button>
                    <button class="admin-tab" onclick="switchAdminTab('blog')">Blog Posts</button>
                    <button class="admin-tab" onclick="switchAdminTab('form-submissions')">Form Submissions</button>
                </div>

                <!-- Articles Tab -->
                <div id="admin-articles" class="admin-content active">
                    <button class="btn-primary" onclick="openArticleForm()">New Article</button>
                    <div class="admin-list" id="adminArticlesList"></div>
                </div>

                <!-- Blog Tab -->
                <div id="admin-blog" class="admin-content">
                    <button class="btn-primary" onclick="openBlogForm()">New Blog Post</button>
                    <div class="admin-list" id="adminBlogList"></div>
                </div>

                <!-- Form Submissions Tab -->
                <div id="admin-form-submissions" class="admin-content">
                    <div id="adminSubmissionsList"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Article Form Modal -->
    <div id="articleFormModal" class="modal">
        <div class="modal-content">
            <button class="modal-close" onclick="closeArticleForm()">&times;</button>
            <h2>Edit Article</h2>
            <form onsubmit="handleArticleSave(event)">
                <div class="form-group">
                    <label>Title</label>
                    <input type="text" id="articleTitle" required>
                </div>
                <div class="form-group">
                    <label>Author</label>
                    <input type="text" id="articleAuthor" required>
                </div>
                <div class="form-group">
                    <label>Category</label>
                    <input type="text" id="articleCategory" required>
                </div>
                <div class="form-group">
                    <label>Language</label>
                    <select id="articleLanguage" required>
                        <option value="EN">English</option>
                        <option value="FR">Français</option>
                        <option value="ES">Español</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Excerpt</label>
                    <input type="text" id="articleExcerpt" required>
                </div>
                <div class="form-group">
                    <label>Content</label>
                    <textarea id="articleContent" required></textarea>
                </div>
                <div class="form-group">
                    <label>Tags (comma separated)</label>
                    <input type="text" id="articleTags">
                </div>
                <button type="submit" class="btn-primary" style="width: 100%;">Save Article</button>
            </form>
        </div>
    </div>

    <!-- Blog Form Modal -->
    <div id="blogFormModal" class="modal">
        <div class="modal-content">
            <button class="modal-close" onclick="closeBlogForm()">&times;</button>
            <h2>Edit Blog Post</h2>
            <form onsubmit="handleBlogSave(event)">
                <div class="form-group">
                    <label>Title</label>
                    <input type="text" id="blogTitle" required>
                </div>
                <div class="form-group">
                    <label>Author</label>
                    <input type="text" id="blogAuthor" required>
                </div>
                <div class="form-group">
                    <label>Category</label>
                    <input type="text" id="blogCategory" required>
                </div>
                <div class="form-group">
                    <label>Language</label>
                    <select id="blogLanguage" required>
                        <option value="EN">English</option>
                        <option value="FR">Français</option>
                        <option value="ES">Español</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Excerpt</label>
                    <input type="text" id="blogExcerpt" required>
                </div>
                <div class="form-group">
                    <label>Content</label>
                    <textarea id="blogContent" required></textarea>
                </div>
                <button type="submit" class="btn-primary" style="width: 100%;">Save Blog Post</button>
            </form>
        </div>
    </div>

    <!-- Home Section -->
    <section id="home" class="section active">
        <div class="hero">
            <div class="hero-content">
                <h1 data-i18n="heroTitle">DuMonde Lab</h1>
                <p class="hero-subtitle" data-i18n="heroSubtitle">Ethical Narratives for a Connected World</p>
                <p style="color: var(--gray); margin-bottom: 30px; font-size: 16px;" data-i18n="heroDescription">Independent think tank on digital diplomacy, political psychology, and data ethics</p>
                <div class="btn-group">
                    <button class="btn-primary" onclick="showSection('research')" data-i18n="heroBtn1">Explore Research</button>
                    <button class="btn-secondary" onclick="showSection('community')" data-i18n="heroBtn2">Join the Community</button>
                </div>
            </div>
        </div>

        <div class="container">
            <h2 class="section-title" data-i18n="whatWeDoTitle">What We Do</h2>
            <div class="what-we-do">
                <div class="card">
                    <h3 data-i18n="whatWeDo1Title">Digital Diplomacy</h3>
                    <p data-i18n="whatWeDo1Desc">Understanding how narratives shape international relations in the digital age</p>
                </div>
                <div class="card">
                    <h3 data-i18n="whatWeDo2Title">Political Emotions & Narratives</h3>
                    <p data-i18n="whatWeDo2Desc">Analyzing the role of emotions in political communication and public opinion</p>
                </div>
                <div class="card">
                    <h3 data-i18n="whatWeDo3Title">Ethical Data & Algorithms</h3>
                    <p data-i18n="whatWeDo3Desc">Exploring algorithmic bias, data ethics, and responsible AI in governance</p>
                </div>
            </div>

            <h2 class="section-title" style="margin-top: 80px;" data-i18n="pillarsTitle">Our Pillars</h2>
            <div class="pillars">
                <div class="pillar">
                    <h4 data-i18n="pillar1">Research</h4>
                </div>
                <div class="pillar">
                    <h4 data-i18n="pillar2">Analytics</h4>
                </div>
                <div class="pillar">
                    <h4 data-i18n="pillar3">Education</h4>
                </div>
                <div class="pillar">
                    <h4 data-i18n="pillar4">Strategy</h4>
                </div>
            </div>

            <h2 class="section-title" style="margin-top: 80px;" data-i18n="newsletterTitle">Newsletter</h2>
            <form onsubmit="handleNewsletterSubmit(event)" style="max-width: 500px; margin-left: auto; margin-right: auto;">
                <div class="form-group">
                    <label data-i18n="newsletterLabel">Email Address</label>
                    <input type="email" placeholder="your@email.com" required>
                </div>
                <button type="submit" class="btn-primary" style="width: 100%;" data-i18n="newsletterBtn">Subscribe</button>
            </form>
        </div>
    </section>

    <!-- About Section -->
    <section id="about" class="section">
        <div class="container">
            <h1 class="section-title" data-i18n="aboutTitle">About DuMonde Lab</h1>
            <div style="max-width: 800px; margin: 0 auto 40px;">
                <p class="section-subtitle" style="text-align: justify;" data-i18n="aboutDesc">
                    DuMonde Lab is an independent think tank dedicated to researching and understanding how narratives, emotions, and data shape international relations in the digital age. We work at the intersection of diplomacy, psychology, and data science to develop ethical frameworks for the connected world.
                </p>
            </div>

            <h2 class="section-title" style="margin-top: 60px;" data-i18n="founderTitle">Founder & Director</h2>
            <div class="card" style="max-width: 500px; margin: 30px auto; text-align: center;">
                <h3>Laura de la Vega Martín</h3>
                <p style="color: var(--primary); font-weight: 600; margin-bottom: 10px;" data-i18n="founderRole">Founder & Director</p>
                <p style="color: var(--gray); font-size: 14px; margin-bottom: 15px;">PhD in Psychology & International Relations</p>
                <p style="color: var(--text); font-size: 14px; line-height: 1.8;" data-i18n="founderBio">
                    Laura combines expertise in political psychology, international relations, and data ethics. Her research focuses on how narratives shape geopolitical outcomes and the psychological mechanisms behind collective decision-making in digital environments.
                </p>
            </div>

            <h2 class="section-title" style="margin-top: 60px;" data-i18n="valuesTitle">Our Values</h2>
            <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 20px; margin-top: 40px;">
                <div class="card" style="text-align: center;">
                    <h4 style="color: var(--primary); margin-bottom: 10px; font-size: 18px;" data-i18n="value1">Ethics</h4>
                    <p style="color: var(--gray); font-size: 14px;" data-i18n="value1Desc">Responsible research and data practices</p>
                </div>
                <div class="card" style="text-align: center;">
                    <h4 style="color: var(--primary); margin-bottom: 10px; font-size: 18px;" data-i18n="value2">Empathy</h4>
                    <p style="color: var(--gray); font-size: 14px;" data-i18n="value2Desc">Understanding diverse perspectives</p>
                </div>
                <div class="card" style="text-align: center;">
                    <h4 style="color: var(--primary); margin-bottom: 10px; font-size: 18px;" data-i18n="value3">Rigor</h4>
                    <p style="color: var(--gray); font-size: 14px;" data-i18n="value3Desc">Evidence-based analysis and research</p>
                </div>
                <div class="card" style="text-align: center;">
                    <h4 style="color: var(--primary); margin-bottom: 10px; font-size: 18px;" data-i18n="value4">Global Solidarity</h4>
                    <p style="color: var(--gray); font-size: 14px;" data-i18n="value4Desc">Inclusive and interconnected world</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Research Section -->
    <section id="research" class="section">
        <div class="container">
            <h1 class="section-title" data-i18n="researchTitle">Research Hub</h1>

            <div class="filters">
                <div class="filter-group">
                    <label data-i18n="filterCategory">Category</label>
                    <select id="categoryFilter" onchange="filterArticles()">
                        <option value="">All Categories</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label data-i18n="filterLanguage">Language</label>
                    <select id="languageFilter" onchange="filterArticles()">
                        <option value="">All Languages</option>
                        <option value="EN">English</option>
                        <option value="FR">Français</option>
                        <option value="ES">Español</option>
                    </select>
                </div>
            </div>

            <div class="articles-grid" id="articles-grid">
                <p style="text-align: center; color: var(--gray);" data-i18n="loadingArticles">Loading articles...</p>
            </div>
        </div>

        <div id="article-detail" class="detail-view">
            <button class="btn-outline btn-sm" onclick="backToArticlesList()" style="margin-bottom: 20px; margin-top: 20px; margin-left: 20px;" data-i18n="backBtn">Back to List</button>
            <div class="detail-header">
                <h1 id="detail-title"></h1>
                <div class="detail-meta">
                    <span id="detail-author"></span>
                    <span id="detail-date"></span>
                    <span id="detail-category"></span>
                </div>
            </div>
            <div class="detail-content">
                <div class="detail-actions">
                    <button class="btn-primary" onclick="shareOnLinkedIn()" data-i18n="shareLinkedIn">Share on LinkedIn</button>
                    <button class="btn-outline" onclick="backToArticlesList()" data-i18n="backBtn">Back to List</button>
                </div>
                <div class="detail-body" id="detail-body"></div>
                <div style="background: #f0f0f0; padding: 20px; border-radius: 8px; margin-bottom: 30px;">
                    <h4 style="margin-bottom: 15px; color: var(--dark);" data-i18n="keyFindings">Key Findings</h4>
                    <ul id="detail-findings" style="list-style-position: inside; color: var(--gray); line-height: 1.8;"></ul>
                </div>
                <div id="detail-tags" class="detail-tags"></div>
            </div>
        </div>
    </section>

    <!-- Analytics Lab Section -->
    <section id="analytics" class="section">
        <div class="container">
            <h1 class="section-title" data-i18n="analyticsTitle">Analytics Lab</h1>
            <p class="section-subtitle" style="max-width: 800px; margin-left: auto; margin-right: auto;" data-i18n="analyticsDesc">
                Explore our data-driven projects and interactive dashboards analyzing political narratives, media influence, and digital trends.
            </p>

            <div class="articles-grid" style="margin-top: 40px;">
                <div class="card">
                    <h3 data-i18n="analytics1">Social Media Sentiment Analysis</h3>
                    <p style="margin-bottom: 15px; color: var(--gray); font-size: 14px;" data-i18n="analytics1Desc">Real-time monitoring of political discourse across major platforms</p>
                    <span class="article-category">Dashboard</span>
                </div>
                <div class="card">
                    <h3 data-i18n="analytics2">Electoral Polarization Index</h3>
                    <p style="margin-bottom: 15px; color: var(--gray); font-size: 14px;" data-i18n="analytics2Desc">Measuring affective polarization trends in democracies worldwide</p>
                    <span class="article-category">Data Brief</span>
                </div>
                <div class="card">
                    <h3 data-i18n="analytics3">Misinformation Spread Tracker</h3>
                    <p style="margin-bottom: 15px; color: var(--gray); font-size: 14px;" data-i18n="analytics3Desc">Analyzing viral narratives and disinformation patterns</p>
                    <span class="article-category">Dashboard</span>
                </div>
            </div>
        </div>
    </section>

    <!-- Community Section -->
    <section id="community" class="section">
        <div class="container">
            <h1 class="section-title" data-i18n="communityTitle">Community</h1>
            <p class="section-subtitle" style="max-width: 800px; margin-left: auto; margin-right: auto; text-align: center;" data-i18n="communityDesc">
                Join a network of researchers, practitioners, and policymakers working on ethics, diplomacy, and digital transformation. We welcome collaborators from all disciplines.
            </p>

            <h2 class="section-title" style="margin-top: 60px; font-size: 28px;" data-i18n="howToContributeTitle">How to Contribute</h2>
            <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 30px; margin-top: 40px; max-width: 1000px; margin-left: auto; margin-right: auto;">
                <div style="text-align: center;">
                    <div style="font-size: 32px; color: var(--primary); margin-bottom: 15px; font-weight: 700;">1</div>
                    <h4 data-i18n="step1Title">Submit a Proposal</h4>
                    <p style="color: var(--gray); font-size: 14px; line-height: 1.7;" data-i18n="step1Desc">Share your research idea or project concept with our team</p>
                </div>
                <div style="text-align: center;">
                    <div style="font-size: 32px; color: var(--primary); margin-bottom: 15px; font-weight: 700;">2</div>
                    <h4 data-i18n="step2Title">Peer Review Process</h4>
                    <p style="color: var(--gray); font-size: 14px; line-height: 1.7;" data-i18n="step2Desc">Our team reviews and provides feedback on your contribution</p>
                </div>
                <div style="text-align: center;">
                    <div style="font-size: 32px; color: var(--primary); margin-bottom: 15px; font-weight: 700;">3</div>
                    <h4 data-i18n="step3Title">Collaborate & Publish</h4>
                    <p style="color: var(--gray); font-size: 14px; line-height: 1.7;" data-i18n="step3Desc">Work with our team and publish your research on our platform</p>
                </div>
            </div>

            <h2 class="section-title" style="margin-top: 80px; font-size: 28px;" data-i18n="becomeContributorTitle">Become a Contributor</h2>
            <form onsubmit="handleContributorSubmit(event)" style="max-width: 600px; margin: 30px auto;">
                <div class="form-group">
                    <label data-i18n="formName">Full Name</label>
                    <input type="text" required>
                </div>
                <div class="form-group">
                    <label data-i18n="formEmail">Email</label>
                    <input type="email" required>
                </div>
                <div class="form-group">
                    <label data-i18n="formCountry">Country</label>
                    <input type="text" required>
                </div>
                <div class="form-group">
                    <label data-i18n="formAreaOfInterest">Area of Interest</label>
                    <select required>
                        <option value="">Select an area</option>
                        <option value="Digital Diplomacy">Digital Diplomacy</option>
                        <option value="AI Ethics">AI Ethics</option>
                        <option value="Political Psychology">Political Psychology</option>
                        <option value="Data Science">Data Science</option>
                    </select>
                </div>
                <div class="form-group">
                    <label data-i18n="formProposal">Short Proposal</label>
                    <textarea placeholder="Tell us about your research or project idea..." required></textarea>
                </div>
                <button type="submit" class="btn-primary" style="width: 100%;" data-i18n="submitBtn">Submit Proposal</button>
            </form>
        </div>
    </section>

    <!-- Services Section -->
    <section id="services" class="section">
        <div class="container">
            <h1 class="section-title" data-i18n="servicesTitle">Services</h1>
            <div class="articles-grid" style="margin-top: 40px;">
                <div class="card">
                    <h3 data-i18n="service1">Strategic Narrative Design</h3>
                    <p style="color: var(--gray); font-size: 14px; line-height: 1.8; margin-bottom: 20px;" data-i18n="service1Desc">Develop ethical, evidence-based narratives for your organization's communication strategy</p>
                    <button class="btn-primary btn-sm" onclick="showSection('contact')" data-i18n="requestBtn">Request Info</button>
                </div>
                <div class="card">
                    <h3 data-i18n="service2">Political Emotions & Perception Analysis</h3>
                    <p style="color: var(--gray); font-size: 14px; line-height: 1.8; margin-bottom: 20px;" data-i18n="service2Desc">Understand public sentiment and emotional drivers affecting your stakeholders</p>
                    <button class="btn-primary btn-sm" onclick="showSection('contact')" data-i18n="requestBtn">Request Info</button>
                </div>
                <div class="card">
                    <h3 data-i18n="service3">Ethical Data Consulting</h3>
                    <p style="color: var(--gray); font-size: 14px; line-height: 1.8; margin-bottom: 20px;" data-i18n="service3Desc">Audit and improve data governance practices with ethical AI principles</p>
                    <button class="btn-primary btn-sm" onclick="showSection('contact')" data-i18n="requestBtn">Request Info</button>
                </div>
            </div>
        </div>
    </section>

    <!-- Blog Section -->
    <section id="blog" class="section">
        <div class="container">
            <h1 class="section-title" data-i18n="blogTitle">Blog</h1>
            <div class="articles-grid" id="blog-grid">
                <p style="text-align: center; color: var(--gray);" data-i18n="loadingBlog">Loading blog posts...</p>
            </div>
        </div>

        <div id="blog-detail" class="detail-view">
            <button class="btn-outline btn-sm" onclick="backToBlogList()" style="margin-bottom: 20px; margin-top: 20px; margin-left: 20px;" data-i18n="backBtn">Back to Blog</button>
            <div class="detail-header">
                <h1 id="blog-detail-title"></h1>
                <div class="detail-meta">
                    <span id="blog-detail-author"></span>
                    <span id="blog-detail-date"></span>
                </div>
            </div>
            <div class="detail-content">
                <div class="detail-actions">
                    <button class="btn-outline" onclick="shareOnLinkedInBlog()" data-i18n="shareLinkedIn">Share on LinkedIn</button>
                    <button class="btn-outline" onclick="backToBlogList()" data-i18n="backBtn">Back to Blog</button>
                </div>
                <div class="detail-body" id="blog-detail-body"></div>
            </div>
        </div>
    </section>

    <!-- Library Section -->
    <section id="library" class="section">
        <div class="container">
            <h1 class="section-title" data-i18n="libraryTitle">Library</h1>
            <p class="section-subtitle" style="max-width: 800px; margin-left: auto; margin-right: auto; text-align: center;" data-i18n="libraryDesc">
                Curated collection of research papers, policy briefs, books, and toolkits on digital diplomacy, ethics, and political psychology
            </p>

            <table class="library-table" id="libraryTable">
                <thead>
                    <tr>
                        <th data-i18n="libTitle">Title</th>
                        <th data-i18n="libType">Type</th>
                        <th data-i18n="libTopic">Topic</th>
                        <th data-i18n="libYear">Year</th>
                    </tr>
                </thead>
                <tbody id="libraryBody">
                    <tr>
                        <td colspan="4" style="text-align: center; color: var(--gray);" data-i18n="loadingLibrary">Loading library...</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </section>

    <!-- Forum Section -->
    <section id="forum" class="section">
        <div class="container">
            <h1 class="section-title" data-i18n="forumTitle">Community Forum</h1>

            <div class="filters">
                <div class="filter-group">
                    <label data-i18n="filterCategory">Category</label>
                    <select id="forumCategoryFilter" onchange="filterTopics()">
                        <option value="">All Categories</option>
                    </select>
                </div>
            </div>

            <div id="topics-list">
                <p style="text-align: center; color: var(--gray);" data-i18n="loadingForum">Loading forum topics...</p>
            </div>
        </div>

        <div id="topic-detail" class="detail-view">
            <button class="btn-outline btn-sm" onclick="backToTopicsList()" style="margin-bottom: 20px; margin-top: 20px; margin-left: 20px;" data-i18n="backBtn">Back to Forum</button>
            <div class="detail-header">
                <h1 id="topic-detail-title"></h1>
                <div class="detail-meta">
                    <span id="topic-detail-starter"></span>
                    <span id="topic-detail-date"></span>
                </div>
            </div>
            <div class="detail-content">
                <div style="background: var(--gray-light); padding: 20px; border-radius: 8px; margin-bottom: 30px;">
                    <p id="topic-detail-excerpt"></p>
                    <button class="like-btn" onclick="toggleTopicLike()" id="topic-like-btn" style="margin-top: 10px;">
                        <span id="topic-like-count">0</span> <span data-i18n="likes">Likes</span>
                    </button>
                </div>

                <div class="replies-list" id="replies-list"></div>

                <h3 style="margin-top: 40px; margin-bottom: 20px;" data-i18n="addReplyTitle">Add Your Reply</h3>
                <form onsubmit="handleReplySubmit(event)" style="background: transparent;">
                    <div class="form-group">
                        <label data-i18n="formName">Name</label>
                        <input type="text" id="replyName" required>
                    </div>
                    <div class="form-group">
                        <label data-i18n="formMessage">Message</label>
                        <textarea placeholder="Share your thoughts..." required id="reply-textarea"></textarea>
                    </div>
                    <button type="submit" class="btn-primary" data-i18n="postReplyBtn">Post Reply</button>
                </form>
            </div>
        </div>
    </section>

    <!-- Subscribe Section -->
    <section id="subscribe" class="section">
        <div class="container">
            <h1 class="section-title" data-i18n="subscribeTitle">Choose Your Plan</h1>
            <p class="section-subtitle" style="max-width: 800px; margin-left: auto; margin-right: auto; text-align: center;" data-i18n="subscribeDesc">
                Select the plan that best fits your needs and unlock exclusive content and features
            </p>

            <div class="plans">
                <div class="plan">
                    <h3 data-i18n="planFree">Free</h3>
                    <p style="color: var(--gray); margin: 15px 0; font-size: 14px;" data-i18n="planFreeDesc">Access to curated content</p>
                    <ul class="plan-features">
                        <li>✓ <span data-i18n="planFeature1">Articles & Blog Posts</span></li>
                        <li>✓ <span data-i18n="planFeature2">Forum Access</span></li>
                        <li>✓ <span data-i18n="planFeature3">Monthly Newsletter</span></li>
                        <li>✗ <span data-i18n="planFeature4">Analytics Dashboard</span></li>
                    </ul>
                    <button class="btn-outline" style="width: 100%; margin-top: 20px;" onclick="selectPlan('free')" data-i18n="choosePlanBtn">Choose Plan</button>
                </div>
                <div class="plan" style="border-color: var(--primary); transform: scale(1.05);">
                    <h3 style="color: var(--primary);" data-i18n="planResearcher">Researcher</h3>
                    <p style="color: var(--gray); margin: 15px 0; font-size: 14px;" data-i18n="planResearcherDesc">Perfect for researchers</p>
                    <ul class="plan-features">
                        <li>✓ <span data-i18n="planFeature5">All Free features</span></li>
                        <li>✓ <span data-i18n="planFeature6">Advanced Research Tools</span></li>
                        <li>✓ <span data-i18n="planFeature7">Data Download</span></li>
                        <li>✓ <span data-i18n="planFeature8">Analytics Dashboard</span></li>
                    </ul>
                    <button class="btn-primary" style="width: 100%; margin-top: 20px;" onclick="selectPlan('researcher')" data-i18n="choosePlanBtn">Choose Plan</button>
                </div>
                <div class="plan">
                    <h3 data-i18n="planInstitutional">Institutional</h3>
                    <p style="color: var(--gray); margin: 15px 0; font-size: 14px;" data-i18n="planInstitutionalDesc">For organizations</p>
                    <ul class="plan-features">
                        <li>✓ <span data-i18n="planFeature9">All Researcher features</span></li>
                        <li>✓ <span data-i18n="planFeature10">Team Accounts (5+)</span></li>
                        <li>✓ <span data-i18n="planFeature11">Custom Analysis</span></li>
                        <li>✓ <span data-i18n="planFeature12">Priority Support</span></li>
                    </ul>
                    <button class="btn-outline" style="width: 100%; margin-top: 20px;" onclick="selectPlan('institutional')" data-i18n="choosePlanBtn">Choose Plan</button>
                </div>
            </div>
        </div>
    </section>

    <!-- Contact Section -->
    <section id="contact" class="section">
        <div class="container">
            <h1 class="section-title" data-i18n="contactTitle">Get in Touch</h1>
            <p class="section-subtitle" style="max-width: 800px; margin-left: auto; margin-right: auto; text-align: center;" data-i18n="contactDesc">
                Have a question or interested in collaborating? We'd love to hear from you.
            </p>

            <form onsubmit="handleContactSubmit(event)" style="max-width: 600px; margin: 30px auto;">
                <div class="form-group">
                    <label data-i18n="formName">Full Name</label>
                    <input type="text" required>
                </div>
                <div class="form-group">
                    <label data-i18n="formEmail">Email</label>
                    <input type="email" required>
                </div>
                <div class="form-group">
                    <label data-i18n="formSubject">Subject</label>
                    <select required>
                        <option value="">Select a subject</option>
                        <option value="Research Inquiry">Research Inquiry</option>
                        <option value="Collaboration">Collaboration Opportunity</option>
                        <option value="Consulting Services">Consulting Services</option>
                    </select>
                </div>
                <div class="form-group">
                    <label data-i18n="formMessage">Message</label>
                    <textarea placeholder="Your message..." required></textarea>
                </div>
                <button type="submit" class="btn-primary" style="width: 100%;" data-i18n="sendBtn">Send Message</button>
            </form>
        </div>
    </section>

    <!-- Footer -->
    <footer>
        <div class="footer-content">
            <p>© 2024 DuMonde Lab. All rights reserved.</p>
            <p>
                <a href="#" class="footer-link">LinkedIn</a> · 
                <a href="#" class="footer-link">Twitter</a> · 
                <a href="#" class="footer-link">Contact</a>
            </p>
        </div>
    </footer>

    <script type="module">
        // ========================================
        // FIREBASE CONFIGURATION
        // ========================================
        // TODO: RELLENAR CON TUS DATOS DE FIREBASE
        
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.0/firebase-app.js";
        import { getFirestore, collection, getDocs, addDoc, updateDoc, deleteDoc, doc, query, where } from "https://www.gstatic.com/firebasejs/10.7.0/firebase-firestore.js";
        import { getAuth, signInWithEmailAndPassword, signOut, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.7.0/firebase-auth.js";

        const firebaseConfig = {
            apiKey: "YOUR_API_KEY",
            authDomain: "YOUR_AUTH_DOMAIN",
            projectId: "YOUR_PROJECT_ID",
            storageBucket: "YOUR_STORAGE_BUCKET",
            messagingSenderId: "YOUR_MESSAGING_SENDER_ID",
            appId: "YOUR_APP_ID"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);
        const auth = getAuth(app);

        // ========================================
        // TRANSLATIONS
        // ========================================
        const translations = {
            en: {
                heroTitle: "DuMonde Lab",
                heroSubtitle: "Ethical Narratives for a Connected World",
                heroDescription: "Independent think tank on digital diplomacy, political psychology, and data ethics",
                heroBtn1: "Explore Research",
                heroBtn2: "Join the Community",
                whatWeDoTitle: "What We Do",
                whatWeDo1Title: "Digital Diplomacy",
                whatWeDo1Desc: "Understanding how narratives shape international relations in the digital age",
                whatWeDo2Title: "Political Emotions & Narratives",
                whatWeDo2Desc: "Analyzing the role of emotions in political communication and public opinion",
                whatWeDo3Title: "Ethical Data & Algorithms",
                whatWeDo3Desc: "Exploring algorithmic bias, data ethics, and responsible AI in governance",
                pillarsTitle: "Our Pillars",
                pillar1: "Research",
                pillar2: "Analytics",
                pillar3: "Education",
                pillar4: "Strategy",
                newsletterTitle: "Newsletter",
                newsletterLabel: "Email Address",
                newsletterBtn: "Subscribe",
                aboutTitle: "About DuMonde Lab",
                aboutDesc: "DuMonde Lab is an independent think tank dedicated to researching and understanding how narratives, emotions, and data shape international relations in the digital age. We work at the intersection of diplomacy, psychology, and data science to develop ethical frameworks for the connected world.",
                founderTitle: "Founder & Director",
                founderRole: "Founder & Director",
                founderBio: "Laura combines expertise in political psychology, international relations, and data ethics. Her research focuses on how narratives shape geopolitical outcomes and the psychological mechanisms behind collective decision-making in digital environments.",
                valuesTitle: "Our Values",
                value1: "Ethics",
                value1Desc: "Responsible research and data practices",
                value2: "Empathy",
                value2Desc: "Understanding diverse perspectives",
                value3: "Rigor",
                value3Desc: "Evidence-based analysis and research",
                value4: "Global Solidarity",
                value4Desc: "Inclusive and interconnected world",
                researchTitle: "Research Hub",
                filterCategory: "Category",
                filterLanguage: "Language",
                loadingArticles: "Loading articles...",
                backBtn: "Back to List",
                shareLinkedIn: "Share on LinkedIn",
                keyFindings: "Key Findings",
                analyticsTitle: "Analytics Lab",
                analyticsDesc: "Explore our data-driven projects and interactive dashboards analyzing political narratives, media influence, and digital trends.",
                analytics1: "Social Media Sentiment Analysis",
                analytics1Desc: "Real-time monitoring of political discourse across major platforms",
                analytics2: "Electoral Polarization Index",
                analytics2Desc: "Measuring affective polarization trends in democracies worldwide",
                analytics3: "Misinformation Spread Tracker",
                analytics3Desc: "Analyzing viral narratives and disinformation patterns",
                communityTitle: "Community",
                communityDesc: "Join a network of researchers, practitioners, and policymakers working on ethics, diplomacy, and digital transformation. We welcome collaborators from all disciplines.",
                howToContributeTitle: "How to Contribute",
                step1Title: "Submit a Proposal",
                step1Desc: "Share your research idea or project concept with our team",
                step2Title: "Peer Review Process",
                step2Desc: "Our team reviews and provides feedback on your contribution",
                step3Title: "Collaborate & Publish",
                step3Desc: "Work with our team and publish your research on our platform",
                becomeContributorTitle: "Become a Contributor",
                formName: "Full Name",
                formEmail: "Email",
                formCountry: "Country",
                formAreaOfInterest: "Area of Interest",
                formProposal: "Short Proposal",
                submitBtn: "Submit Proposal",
                servicesTitle: "Services",
                service1: "Strategic Narrative Design",
                service1Desc: "Develop ethical, evidence-based narratives for your organization's communication strategy",
                service2: "Political Emotions & Perception Analysis",
                service2Desc: "Understand public sentiment and emotional drivers affecting your stakeholders",
                service3: "Ethical Data Consulting",
                service3Desc: "Audit and improve data governance practices with ethical AI principles",
                requestBtn: "Request Info",
                blogTitle: "Blog",
                loadingBlog: "Loading blog posts...",
                libraryTitle: "Library",
                libraryDesc: "Curated collection of research papers, policy briefs, books, and toolkits on digital diplomacy, ethics, and political psychology",
                libTitle: "Title",
                libType: "Type",
                libTopic: "Topic",
                libYear: "Year",
                loadingLibrary: "Loading library...",
                forumTitle: "Community Forum",
                loadingForum: "Loading forum topics...",
                addReplyTitle: "Add Your Reply",
                formMessage: "Message",
                postReplyBtn: "Post Reply",
                likes: "Likes",
                subscribeTitle: "Choose Your Plan",
                subscribeDesc: "Select the plan that best fits your needs and unlock exclusive content and features",
                planFree: "Free",
                planFreeDesc: "Access to curated content",
                planResearcher: "Researcher",
                planResearcherDesc: "Perfect for researchers",
                planInstitutional: "Institutional",
                planInstitutionalDesc: "For organizations",
                planFeature1: "Articles & Blog Posts",
                planFeature2: "Forum Access",
                planFeature3: "Monthly Newsletter",
                planFeature4: "Analytics Dashboard",
                planFeature5: "All Free features",
                planFeature6: "Advanced Research Tools",
                planFeature7: "Data Download",
                planFeature8: "Analytics Dashboard",
                planFeature9: "All Researcher features",
                planFeature10: "Team Accounts (5+)",
                planFeature11: "Custom Analysis",
                planFeature12: "Priority Support",
                choosePlanBtn: "Choose Plan",
                contactTitle: "Get in Touch",
                contactDesc: "Have a question or interested in collaborating? We'd love to hear from you.",
                formSubject: "Subject",
                sendBtn: "Send Message",
                adminLoginTitle: "Admin Login"
            },
            fr: {
                heroTitle: "DuMonde Lab",
                heroSubtitle: "Récits Éthiques pour un Monde Connecté",
                heroDescription: "Laboratoire de réflexion indépendant sur la diplomatie numérique, la psychologie politique et l'éthique des données",
                heroBtn1: "Explorer la Recherche",
                heroBtn2: "Rejoindre la Communauté",
                whatWeDoTitle: "Ce Que Nous Faisons",
                whatWeDo1Title: "Diplomatie Numérique",
                whatWeDo1Desc: "Comprendre comment les récits façonnent les relations internationales à l'ère numérique",
                whatWeDo2Title: "Émotions Politiques & Récits",
                whatWeDo2Desc: "Analyser le rôle des émotions dans la communication politique et l'opinion publique",
                whatWeDo3Title: "Données & Algorithmes Éthiques",
                whatWeDo3Desc: "Explorer les biais algorithmiques, l'éthique des données et l'IA responsable en gouvernance",
                pillarsTitle: "Nos Piliers",
                pillar1: "Recherche",
                pillar2: "Analytique",
                pillar3: "Éducation",
                pillar4: "Stratégie",
                newsletterTitle: "Infolettre",
                newsletterLabel: "Adresse Email",
                newsletterBtn: "S'abonner",
                aboutTitle: "À Propos de DuMonde Lab",
                aboutDesc: "DuMonde Lab est un laboratoire de réflexion indépendant dédié à la recherche et à la compréhension de la façon dont les récits, les émotions et les données façonnent les relations internationales à l'ère numérique.",
                founderTitle: "Fondatrice & Directrice",
                founderRole: "Fondatrice & Directrice",
                founderBio: "Laura combine une expertise en psychologie politique, relations internationales et éthique des données.",
                valuesTitle: "Nos Valeurs",
                value1: "Éthique",
                value1Desc: "Pratiques de recherche et de données responsables",
                value2: "Empathie",
                value2Desc: "Comprendre les perspectives diverses",
                value3: "Rigueur",
                value3Desc: "Analyse et recherche basées sur des preuves",
                value4: "Solidarité Mondiale",
                value4Desc: "Monde inclusif et interconnecté",
                researchTitle: "Centre de Recherche",
                filterCategory: "Catégorie",
                filterLanguage: "Langue",
                loadingArticles: "Chargement des articles...",
                backBtn: "Retour à la liste",
                shareLinkedIn: "Partager sur LinkedIn",
                keyFindings: "Résultats Clés",
                analyticsTitle: "Labo Analytique",
                analyticsDesc: "Explorez nos projets basés sur les données et tableaux de bord interactifs analysant les récits politiques.",
                analytics1: "Analyse du Sentiment sur les Réseaux Sociaux",
                analytics1Desc: "Suivi en temps réel du discours politique sur les principales plateformes",
                analytics2: "Indice de Polarisation Électorale",
                analytics2Desc: "Mesurer les tendances de polarisation dans les démocraties du monde entier",
                analytics3: "Suivi de la Propagation de la Désinformation",
                analytics3Desc: "Analyser les récits viraux et les motifs de désinformation",
                communityTitle: "Communauté",
                communityDesc: "Rejoignez un réseau de chercheurs, praticiens et décideurs travaillant sur l'éthique, la diplomatie et la transformation numérique.",
                howToContributeTitle: "Comment Contribuer",
                step1Title: "Soumettre une Proposition",
                step1Desc: "Partagez votre idée de recherche ou concept de projet avec notre équipe",
                step2Title: "Processus d'Examen par les Pairs",
                step2Desc: "Notre équipe examine et fournit des commentaires sur votre contribution",
                step3Title: "Collaborer & Publier",
                step3Desc: "Travaillez avec notre équipe et publiez votre recherche sur notre plateforme",
                becomeContributorTitle: "Devenir un Contributeur",
                formName: "Nom Complet",
                formEmail: "Email",
                formCountry: "Pays",
                formAreaOfInterest: "Domaine d'Intérêt",
                formProposal: "Proposition Courte",
                submitBtn: "Soumettre une Proposition",
                servicesTitle: "Services",
                service1: "Conception de Récits Stratégiques",
                service1Desc: "Développer des récits éthiques et basés sur des preuves pour votre stratégie de communication",
                service2: "Analyse des Émotions Politiques & Perception",
                service2Desc: "Comprendre le sentiment public et les moteurs émotionnels affectant vos parties prenantes",
                service3: "Consultation en Données Éthiques",
                service3Desc: "Auditer et améliorer les pratiques de gouvernance des données avec des principes d'IA responsable",
                requestBtn: "Demander des Informations",
                blogTitle: "Blog",
                loadingBlog: "Chargement des articles du blog...",
                libraryTitle: "Bibliothèque",
                libraryDesc: "Collection organisée d'articles de recherche, brefs politiques, livres et kits d'outils sur la diplomatie numérique, l'éthique et la psychologie politique",
                libTitle: "Titre",
                libType: "Type",
                libTopic: "Sujet",
                libYear: "Année",
                loadingLibrary: "Chargement de la bibliothèque...",
                forumTitle: "Forum Communautaire",
                loadingForum: "Chargement des sujets du forum...",
                addReplyTitle: "Ajouter Votre Réponse",
                formMessage: "Message",
                postReplyBtn: "Publier la Réponse",
                likes: "J'aime",
                subscribeTitle: "Choisir Votre Plan",
                subscribeDesc: "Sélectionnez le plan qui correspond le mieux à vos besoins et déverrouillez du contenu et des fonctionnalités exclusifs",
                planFree: "Gratuit",
                planFreeDesc: "Accès au contenu curé",
                planResearcher: "Chercheur",
                planResearcherDesc: "Parfait pour les chercheurs",
                planInstitutional: "Institutionnel",
                planInstitutionalDesc: "Pour les organisations",
                planFeature1: "Articles & Articles de Blog",
                planFeature2: "Accès au Forum",
                planFeature3: "Infolettre Mensuelle",
                planFeature4: "Tableau de Bord Analytique",
                planFeature5: "Toutes les fonctionnalités gratuites",
                planFeature6: "Outils de Recherche Avancés",
                planFeature7: "Téléchargement des Données",
                planFeature8: "Tableau de Bord Analytique",
                planFeature9: "Toutes les fonctionnalités Chercheur",
                planFeature10: "Comptes d'Équipe (5+)",
                planFeature11: "Analyse Personnalisée",
                planFeature12: "Support Prioritaire",
                choosePlanBtn: "Choisir le Plan",
                contactTitle: "Nous Contacter",
                contactDesc: "Avez-vous une question ou intéressé par une collaboration? Nous aimerions vous entendre.",
                formSubject: "Sujet",
                sendBtn: "Envoyer le Message",
                adminLoginTitle: "Connexion Admin"
            },
            es: {
                heroTitle: "DuMonde Lab",
                heroSubtitle: "Narrativas Éticas para un Mundo Conectado",
                heroDescription: "Laboratorio de ideas independiente sobre diplomacia digital, psicología política y ética de datos",
                heroBtn1: "Explorar Investigación",
                heroBtn2: "Únete a la Comunidad",
                whatWeDoTitle: "Qué Hacemos",
                whatWeDo1Title: "Diplomacia Digital",
                whatWeDo1Desc: "Comprender cómo las narrativas moldean las relaciones internacionales en la era digital",
                whatWeDo2Title: "Emociones Políticas & Narrativas",
                whatWeDo2Desc: "Analizar el papel de las emociones en la comunicación política y la opinión pública",
                whatWeDo3Title: "Datos & Algoritmos Éticos",
                whatWeDo3Desc: "Explorar sesgos algorítmicos, ética de datos e IA responsable en gobernanza",
                pillarsTitle: "Nuestros Pilares",
                pillar1: "Investigación",
                pillar2: "Análisis",
                pillar3: "Educación",
                pillar4: "Estrategia",
                newsletterTitle: "Boletín",
                newsletterLabel: "Dirección de Correo",
                newsletterBtn: "Suscribirse",
                aboutTitle: "Acerca de DuMonde Lab",
                aboutDesc: "DuMonde Lab es un laboratorio de ideas independiente dedicado a investigar y comprender cómo las narrativas, emociones y datos moldean las relaciones internacionales en la era digital.",
                founderTitle: "Fundadora & Directora",
                founderRole: "Fundadora & Directora",
                founderBio: "Laura combina experiencia en psicología política, relaciones internacionales y ética de datos.",
                valuesTitle: "Nuestros Valores",
                value1: "Ética",
                value1Desc: "Prácticas de investigación y datos responsables",
                value2: "Empatía",
                value2Desc: "Comprender perspectivas diversas",
                value3: "Rigor",
                value3Desc: "Análisis e investigación basados en evidencia",
                value4: "Solidaridad Global",
                value4Desc: "Mundo inclusivo e interconectado",
                researchTitle: "Centro de Investigación",
                filterCategory: "Categoría",
                filterLanguage: "Idioma",
                loadingArticles: "Cargando artículos...",
                backBtn: "Volver a la lista",
                shareLinkedIn: "Compartir en LinkedIn",
                keyFindings: "Hallazgos Clave",
                analyticsTitle: "Laboratorio de Análisis",
                analyticsDesc: "Explora nuestros proyectos basados en datos y paneles interactivos que analizan narrativas políticas.",
                analytics1: "Análisis del Sentimiento en Redes Sociales",
                analytics1Desc: "Monitoreo en tiempo real del discurso político en las principales plataformas",
                analytics2: "Índice de Polarización Electoral",
                analytics2Desc: "Medir tendencias de polarización en democracias en todo el mundo",
                analytics3: "Seguimiento de Propagación de Desinformación",
                analytics3Desc: "Analizar narrativas virales y patrones de desinformación",
                communityTitle: "Comunidad",
                communityDesc: "Únete a una red de investigadores, profesionales y formuladores de políticas trabajando en ética, diplomacia y transformación digital.",
                howToContributeTitle: "Cómo Contribuir",
                step1Title: "Enviar una Propuesta",
                step1Desc: "Comparte tu idea de investigación o concepto de proyecto con nuestro equipo",
                step2Title: "Proceso de Revisión Colegiada",
                step2Desc: "Nuestro equipo revisa tu contribución y proporciona comentarios",
                step3Title: "Colaborar & Publicar",
                step3Desc: "Trabaja con nuestro equipo y publica tu investigación en nuestra plataforma",
                becomeContributorTitle: "Conviértete en Colaborador",
                formName: "Nombre Completo",
                formEmail: "Correo Electrónico",
                formCountry: "País",
                formAreaOfInterest: "Área de Interés",
                formProposal: "Propuesta Breve",
                submitBtn: "Enviar Propuesta",
                servicesTitle: "Servicios",
                service1: "Diseño de Narrativas Estratégicas",
                service1Desc: "Desarrolla narrativas éticas y basadas en evidencia para tu estrategia de comunicación",
                service2: "Análisis de Emociones Políticas & Percepción",
                service2Desc: "Comprende el sentimiento público y los impulsores emocionales que afectan a tus partes interesadas",
                service3: "Consultoría en Datos Éticos",
                service3Desc: "Audita y mejora las prácticas de gobernanza de datos con principios de IA responsable",
                requestBtn: "Solicitar Información",
                blogTitle: "Blog",
                loadingBlog: "Cargando posts del blog...",
                libraryTitle: "Biblioteca",
                libraryDesc: "Colección curada de artículos de investigación, informes de políticas, libros y kits de herramientas sobre diplomacia digital, ética y psicología política",
                libTitle: "Título",
                libType: "Tipo",
                libTopic: "Tema",
                libYear: "Año",
                loadingLibrary: "Cargando biblioteca...",
                forumTitle: "Foro Comunitario",
                loadingForum: "Cargando temas del foro...",
                addReplyTitle: "Agregar Tu Respuesta",
                formMessage: "Mensaje",
                postReplyBtn: "Publicar Respuesta",
                likes: "Me gusta",
                subscribeTitle: "Elige Tu Plan",
                subscribeDesc: "Selecciona el plan que mejor se adapte a tus necesidades y desbloquea contenido y características exclusivas",
                planFree: "Gratis",
                planFreeDesc: "Acceso a contenido curado",
                planResearcher: "Investigador",
                planResearcherDesc: "Perfecto para investigadores",
                planInstitutional: "Institucional",
                planInstitutionalDesc: "Para organizaciones",
                planFeature1: "Artículos y Posts de Blog",
                planFeature2: "Acceso al Foro",
                planFeature3: "Boletín Mensual",
                planFeature4: "Panel de Análisis",
                planFeature5: "Todas las funciones gratuitas",
                planFeature6: "Herramientas de Investigación Avanzadas",
                planFeature7: "Descarga de Datos",
                planFeature8: "Panel de Análisis",
                planFeature9: "Todas las funciones de Investigador",
                planFeature10: "Cuentas de Equipo (5+)",
                planFeature11: "Análisis Personalizado",
                planFeature12: "Soporte Prioritario",
                choosePlanBtn: "Elige el Plan",
                contactTitle: "Ponte en Contacto",
                contactDesc: "¿Tienes una pregunta o estás interesado en colaborar? Nos encantaría saber de ti.",
                formSubject: "Asunto",
                sendBtn: "Enviar Mensaje",
                adminLoginTitle: "Inicio de Sesión de Admin"
            }
        };

        // ========================================
        // STATE MANAGEMENT
        // ========================================
        let currentLanguage = localStorage.getItem('language') || 'en';
        let currentUser = null;
        let isAdmin = false;
        let currentArticleId = null;
        let currentBlogId = null;
        let currentTopicId = null;

        // ========================================
        // INITIALIZATION
        // ========================================
        function initApp() {
            updatePageLanguage();
            loadArticles();
            loadBlogPosts();
            loadTopics();
            loadLibrary();
            setupAuthListener();
            updateCategoryFilters();
        }

        function setupAuthListener() {
            onAuthStateChanged(auth, (user) => {
                currentUser = user;
                isAdmin = user ? true : false;
                if (isAdmin) {
                    loadAdminData();
                }
            });
        }

        // ========================================
        // LANGUAGE MANAGEMENT
        // ========================================
        function changeLanguage(lang) {
            currentLanguage = lang;
            localStorage.setItem('language', lang);
            updatePageLanguage();
            updateActiveLanguage();
            loadArticles();
            loadBlogPosts();
            loadTopics();
            loadLibrary();
        }

        function updatePageLanguage() {
            const elements = document.querySelectorAll('[data-i18n]');
            elements.forEach(element => {
                const key = element.getAttribute('data-i18n');
                element.textContent = translations[currentLanguage]?.[key] || key;
            });
        }

        function updateActiveLanguage() {
            document.querySelectorAll('.lang-option').forEach(el => {
                el.classList.remove('active');
            });
            document.querySelectorAll('.lang-option').forEach(el => {
                if (el.textContent.toLowerCase() === currentLanguage.toLowerCase()) {
                    el.classList.add('active');
                }
            });
        }

        function t(key) {
            return translations[currentLanguage]?.[key] || key;
        }

        // ========================================
        // NAVIGATION
        // ========================================
        window.showSection = function(section) {
            if (section === 'admin' && !isAdmin) {
                toggleAdminLogin();
                return;
            }

            document.querySelectorAll('.section, .detail-view').forEach(s => {
                s.classList.remove('active');
            });
            document.getElementById(section)?.classList.add('active');
            window.scrollTo(0, 0);
            closeMenu();
        };

        function toggleMenu() {
            document.querySelector('.nav-menu').classList.toggle('active');
        }

        function closeMenu() {
            document.querySelector('.nav-menu').classList.remove('active');
        }

        // ========================================
        // NOTIFICATIONS
        // ========================================
        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.textContent = message;
            document.body.appendChild(notification);

            setTimeout(() => {
                notification.classList.add('removing');
                setTimeout(() => notification.remove(), 300);
            }, 3000);
        }

        // ========================================
        // ARTICLES / RESEARCH
        // ========================================
        async function loadArticles() {
            try {
                const articlesGrid = document.getElementById('articles-grid');
                articlesGrid.innerHTML = '<p style="text-align: center; color: var(--gray);">Loading articles...</p>';

                const q = query(collection(db, 'articles'), where('language', '==', currentLanguage));
                const querySnapshot = await getDocs(q);

                if (querySnapshot.empty) {
                    articlesGrid.innerHTML = '<p style="text-align: center; color: var(--gray);">No articles available in this language</p>';
                    return;
                }

                const articles = [];
                querySnapshot.forEach((doc) => {
                    articles.push({ id: doc.id, ...doc.data() });
                });

                updateCategoryFilters();
                filterArticles();
            } catch (error) {
                console.error('Error loading articles:', error);
                showNotification('Error loading articles', 'error');
            }
        }

        async function filterArticles() {
            try {
                const categoryFilter = document.getElementById('categoryFilter')?.value || '';
                const languageFilter = document.getElementById('languageFilter')?.value || currentLanguage;
                let q;

                if (categoryFilter && languageFilter) {
                    q = query(collection(db, 'articles'), where('category', '==', categoryFilter), where('language', '==', languageFilter));
                } else if (categoryFilter) {
                    q = query(collection(db, 'articles'), where('category', '==', categoryFilter));
                } else if (languageFilter) {
                    q = query(collection(db, 'articles'), where('language', '==', languageFilter));
                } else {
                    q = collection(db, 'articles');
                }

                const querySnapshot = await getDocs(q);
                const articlesGrid = document.getElementById('articles-grid');
                articlesGrid.innerHTML = '';

                if (querySnapshot.empty) {
                    articlesGrid.innerHTML = '<p style="text-align: center; color: var(--gray); grid-column: 1/-1;">No articles found</p>';
                    return;
                }

                querySnapshot.forEach((doc) => {
                    const article = { id: doc.id, ...doc.data() };
                    const card = createArticleCard(article);
                    articlesGrid.appendChild(card);
                });
            } catch (error) {
                console.error('Error filtering articles:', error);
            }
        }

        function createArticleCard(article) {
            const card = document.createElement('div');
            card.className = 'article-card';
            card.onclick = () => viewArticle(article);
            card.innerHTML = `
                <div class="article-card-image">Research Image</div>
                <div class="article-card-content">
                    <span class="article-category">${article.category || 'General'}</span>
                    <h4>${article.title || 'Untitled'}</h4>
                    <p class="article-excerpt">${article.excerpt || 'No description'}</p>
                    <div class="article-meta">
                        <span>${article.author || 'Anonymous'}</span>
                        <span>${new Date(article.date).toLocaleDateString() || 'N/A'}</span>
                    </div>
                </div>
            `;
            return card;
        }

        window.viewArticle = function(article) {
            currentArticleId = article.id;
            document.getElementById('detail-title').textContent = article.title;
            document.getElementById('detail-author').textContent = `By ${article.author}`;
            document.getElementById('detail-date').textContent = new Date(article.date).toLocaleDateString();
            document.getElementById('detail-category').textContent = article.category;
            document.getElementById('detail-body').textContent = article.content || 'No content available';
            
            // Key Findings
            const findings = document.getElementById('detail-findings');
            findings.innerHTML = '';
            if (article.findings && Array.isArray(article.findings)) {
                article.findings.forEach(finding => {
                    const li = document.createElement('li');
                    li.textContent = finding;
                    findings.appendChild(li);
                });
            }

            // Tags
            const tagsContainer = document.getElementById('detail-tags');
            tagsContainer.innerHTML = '';
            if (article.tags && Array.isArray(article.tags)) {
                article.tags.forEach(tag => {
                    const tagEl = document.createElement('span');
                    tagEl.className = 'tag';
                    tagEl.textContent = tag;
                    tagsContainer.appendChild(tagEl);
                });
            }

            document.getElementById('articles-grid').parentElement.style.display = 'none';
            document.getElementById('article-detail').classList.add('active');
        };

        window.backToArticlesList = function() {
            document.getElementById('article-detail').classList.remove('active');
            document.getElementById('articles-grid').parentElement.style.display = 'block';
            currentArticleId = null;
        };

        window.shareOnLinkedIn = function() {
            const url = window.location.href;
            window.open(`https://www.linkedin.com/sharing/share-offsite/?url=${encodeURIComponent(url)}`, 'linkedin', 'width=550,height=420');
        };

        async function updateCategoryFilters() {
            try {
                const querySnapshot = await getDocs(collection(db, 'articles'));
                const categories = new Set();
                
                querySnapshot.forEach((doc) => {
                    if (doc.data().category) {
                        categories.add(doc.data().category);
                    }
                });

                const categoryFilter = document.getElementById('categoryFilter');
                const forumFilter = document.getElementById('forumCategoryFilter');
                
                if (categoryFilter) {
                    const currentValue = categoryFilter.value;
                    categoryFilter.innerHTML = '<option value="">All Categories</option>';
                    categories.forEach(cat => {
                        const option = document.createElement('option');
                        option.value = cat;
                        option.textContent = cat;
                        categoryFilter.appendChild(option);
                    });
                    categoryFilter.value = currentValue;
                }

                // Forum categories
                const forumQuerySnapshot = await getDocs(collection(db, 'topics'));
                const forumCategories = new Set();
                
                forumQuerySnapshot.forEach((doc) => {
                    if (doc.data().category) {
                        forumCategories.add(doc.data().category);
                    }
                });

                if (forumFilter) {
                    const currentValue = forumFilter.value;
                    forumFilter.innerHTML = '<option value="">All Categories</option>';
                    forumCategories.forEach(cat => {
                        const option = document.createElement('option');
                        option.value = cat;
                        option.textContent = cat;
                        forumFilter.appendChild(option);
                    });
                    forumFilter.value = currentValue;
                }
            } catch (error) {
                console.error('Error updating filters:', error);
            }
        }

        // ========================================
        // BLOG
        // ========================================
        async function loadBlogPosts() {
            try {
                const q = query(collection(db, 'blogPosts'), where('language', '==', currentLanguage));
                const querySnapshot = await getDocs(q);
                const blogGrid = document.getElementById('blog-grid');
                blogGrid.innerHTML = '';

                if (querySnapshot.empty) {
                    blogGrid.innerHTML = '<p style="text-align: center; color: var(--gray);">No blog posts available</p>';
                    return;
                }

                querySnapshot.forEach((doc) => {
                    const post = { id: doc.id, ...doc.data() };
                    const card = document.createElement('div');
                    card.className = 'article-card';
                    card.onclick = () => viewBlog(post);
                    card.innerHTML = `
                        <div class="article-card-image">Blog Image</div>
                        <div class="article-card-content">
                            <h4>${post.title || 'Untitled'}</h4>
                            <p class="article-excerpt">${post.excerpt || 'No description'}</p>
                            <div class="article-meta">
                                <span>${post.author || 'Anonymous'}</span>
                                <span>${new Date(post.date).toLocaleDateString() || 'N/A'}</span>
                            </div>
                        </div>
                    `;
                    blogGrid.appendChild(card);
                });
            } catch (error) {
                console.error('Error loading blog posts:', error);
            }
        }

        window.viewBlog = function(post) {
            currentBlogId = post.id;
            document.getElementById('blog-detail-title').textContent = post.title;
            document.getElementById('blog-detail-author').textContent = `By ${post.author}`;
            document.getElementById('blog-detail-date').textContent = new Date(post.date).toLocaleDateString();
            document.getElementById('blog-detail-body').textContent = post.content || 'No content available';

            document.getElementById('blog-grid').parentElement.style.display = 'none';
            document.getElementById('blog-detail').classList.add('active');
        };

        window.backToBlogList = function() {
            document.getElementById('blog-detail').classList.remove('active');
            document.getElementById('blog-grid').parentElement.style.display = 'grid';
            currentBlogId = null;
        };

        window.shareOnLinkedInBlog = function() {
            const url = window.location.href;
            window.open(`https://www.linkedin.com/sharing/share-offsite/?url=${encodeURIComponent(url)}`, 'linkedin', 'width=550,height=420');
        };

        // ========================================
        // FORUM
        // ========================================
        async function loadTopics() {
            try {
                const querySnapshot = await getDocs(collection(db, 'topics'));
                const topicsList = document.getElementById('topics-list');
                topicsList.innerHTML = '';

                if (querySnapshot.empty) {
                    topicsList.innerHTML = '<p style="text-align: center; color: var(--gray);">No forum topics available</p>';
                    return;
                }

                querySnapshot.forEach((doc) => {
                    const topic = { id: doc.id, ...doc.data() };
                    const card = document.createElement('div');
                    card.className = 'topic-card';
                    card.onclick = () => viewTopic(topic);
                    card.innerHTML = `
                        <div class="topic-header">
                            <div>
                                <h4>${topic.title || 'Untitled'}</h4>
                                <p style="color: var(--gray); font-size: 13px; margin-top: 5px;">Started by ${topic.starter || 'Anonymous'}</p>
                            </div>
                            <span class="article-category">${topic.category || 'General'}</span>
                        </div>
                        <div class="topic-stats">
                            <span>${topic.replyCount || 0} Replies</span>
                            <span>${topic.likes || 0} Likes</span>
                            <span>${new Date(topic.date).toLocaleDateString()}</span>
                        </div>
                    `;
                    topicsList.appendChild(card);
                });
            } catch (error) {
                console.error('Error loading topics:', error);
            }
        }

        async function filterTopics() {
            try {
                const categoryFilter = document.getElementById('forumCategoryFilter')?.value || '';
                let q;

                if (categoryFilter) {
                    q = query(collection(db, 'topics'), where('category', '==', categoryFilter));
                } else {
                    q = collection(db, 'topics');
                }

                const querySnapshot = await getDocs(q);
                const topicsList = document.getElementById('topics-list');
                topicsList.innerHTML = '';

                if (querySnapshot.empty) {
                    topicsList.innerHTML = '<p style="text-align: center; color: var(--gray);">No topics found</p>';
                    return;
                }

                querySnapshot.forEach((doc) => {
                    const topic = { id: doc.id, ...doc.data() };
                    const card = document.createElement('div');
                    card.className = 'topic-card';
                    card.onclick = () => viewTopic(topic);
                    card.innerHTML = `
                        <div class="topic-header">
                            <div>
                                <h4>${topic.title}</h4>
                                <p style="color: var(--gray); font-size: 13px; margin-top: 5px;">Started by ${topic.starter}</p>
                            </div>
                            <span class="article-category">${topic.category}</span>
                        </div>
                        <div class="topic-stats">
                            <span>${topic.replyCount || 0} Replies</span>
                            <span>${topic.likes || 0} Likes</span>
                            <span>${new Date(topic.date).toLocaleDateString()}</span>
                        </div>
                    `;
                    topicsList.appendChild(card);
                });
            } catch (error) {
                console.error('Error filtering topics:', error);
            }
        }

        window.viewTopic = async function(topic) {
            currentTopicId = topic.id;
            document.getElementById('topic-detail-title').textContent = topic.title;
            document.getElementById('topic-detail-starter').textContent = `Started by ${topic.starter}`;
            document.getElementById('topic-detail-date').textContent = new Date(topic.date).toLocaleDateString();
            document.getElementById('topic-detail-excerpt').textContent = topic.excerpt || 'No description';

            const likesCount = topic.likes || 0;
            document.getElementById('topic-like-count').textContent = likesCount;

            try {
                const repliesQuerySnapshot = await getDocs(query(collection(db, 'replies'), where('topicId', '==', topic.id)));
                const repliesList = document.getElementById('replies-list');
                repliesList.innerHTML = '';

                repliesQuerySnapshot.forEach((doc) => {
                    const reply = { id: doc.id, ...doc.data() };
                    const replyEl = document.createElement('div');
                    replyEl.className = 'reply';
                    replyEl.innerHTML = `
                        <div class="reply-author">${reply.author || 'Anonymous'}</div>
                        <div class="reply-date">${new Date(reply.date).toLocaleDateString()}</div>
                        <div class="reply-content">${reply.content}</div>
                        <button class="like-btn" onclick="toggleReplyLike('${reply.id}')">
                            <span>${reply.likes || 0}</span> Likes
                        </button>
                    `;
                    repliesList.appendChild(replyEl);
                });
            } catch (error) {
                console.error('Error loading replies:', error);
            }

            document.getElementById('topics-list').style.display = 'none';
            document.getElementById('topic-detail').classList.add('active');
        };

        window.backToTopicsList = function() {
            document.getElementById('topic-detail').classList.remove('active');
            document.getElementById('topics-list').style.display = 'block';
            currentTopicId = null;
        };

        window.toggleTopicLike = async function() {
            try {
                if (!currentTopicId) return;
                
                const topicRef = doc(db, 'topics', currentTopicId);
                const currentLikes = parseInt(document.getElementById('topic-like-count').textContent);
                await updateDoc(topicRef, { likes: currentLikes + 1 });
                document.getElementById('topic-like-count').textContent = currentLikes + 1;
                showNotification('Liked!', 'success');
            } catch (error) {
                console.error('Error liking topic:', error);
                showNotification('Error liking topic', 'error');
            }
        };

        window.toggleReplyLike = async function(replyId) {
            try {
                const replyRef = doc(db, 'replies', replyId);
                const replyDoc = await getDocs(query(collection(db, 'replies'), where('id', '==', replyId)));
                
                // Simplified: just add 1 to likes
                // In production, track who liked what
                showNotification('Liked!', 'success');
            } catch (error) {
                console.error('Error liking reply:', error);
                showNotification('Error liking reply', 'error');
            }
        };

        window.handleReplySubmit = async function(event) {
            event.preventDefault();
            try {
                if (!currentTopicId) return;

                const form = event.target;
                const name = form.querySelector('#replyName').value;
                const content = form.querySelector('#reply-textarea').value;

                await addDoc(collection(db, 'replies'), {
                    topicId: currentTopicId,
                    author: name,
                    content: content,
                    date: new Date().toISOString(),
                    likes: 0
                });

                // Update topic reply count
                const topicRef = doc(db, 'topics', currentTopicId);
                const topicDoc = await getDocs(query(collection(db, 'topics'), where('id', '==', currentTopicId)));
                
                form.reset();
                showNotification('Reply posted successfully!', 'success');
                
                // Reload topic
                const topics = await getDocs(query(collection(db, 'topics'), where('id', '==', currentTopicId)));
                if (!topics.empty) {
                    const topic = { id: topics.docs.id, ...topics.docs.data() };
                    viewTopic(topic);
                }
            } catch (error) {
                console.error('Error posting reply:', error);
                showNotification('Error posting reply', 'error');
            }
        };

        // ========================================
        // LIBRARY
        // ========================================
        async function loadLibrary() {
            try {
                const querySnapshot = await getDocs(collection(db, 'library'));
                const libraryBody = document.getElementById('libraryBody');
                libraryBody.innerHTML = '';

                if (querySnapshot.empty) {
                    libraryBody.innerHTML = '<tr><td colspan="4" style="text-align: center; color: var(--gray);">No library items available</td></tr>';
                    return;
                }

                querySnapshot.forEach((doc) => {
                    const item = doc.data();
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td><strong>${item.title || 'Untitled'}</strong></td>
                        <td>${item.type || 'N/A'}</td>
                        <td>${item.topic || 'General'}</td>
                        <td>${item.year || 'N/A'}</td>
                    `;
                    libraryBody.appendChild(row);
                });
            } catch (error) {
                console.error('Error loading library:', error);
            }
        }

        // ========================================
        // FORMS
        // ========================================
        window.handleNewsletterSubmit = async function(event) {
            event.preventDefault();
            try {
                const form = event.target;
                const email = form.querySelector('input[type="email"]').value;

                await addDoc(collection(db, 'newsletterSubscribers'), {
                    email: email,
                    subscribedAt: new Date().toISOString()
                });

                form.reset();
                showNotification(t('newsletterBtn') + ' successful!', 'success');
            } catch (error) {
                console.error('Error subscribing to newsletter:', error);
                showNotification('Error subscribing', 'error');
            }
        };

        window.handleContactSubmit = async function(event) {
            event.preventDefault();
            try {
                const form = event.target;
                const name = form.querySelector('input[type="text"]').value;
                const email = form.querySelector('input[type="email"]').value;
                const subject = form.querySelector('select').value;
                const message = form.querySelector('textarea').value;

                await addDoc(collection(db, 'contactMessages'), {
                    name: name,
                    email: email,
                    subject: subject,
                    message: message,
                    submittedAt: new Date().toISOString()
                });

                form.reset();
                showNotification('Message sent successfully!', 'success');
            } catch (error) {
                console.error('Error sending contact form:', error);
                showNotification('Error sending message', 'error');
            }
        };

        window.handleContributorSubmit = async function(event) {
            event.preventDefault();
            try {
                const form = event.target;
                const name = form.querySelector('input[type="text"]').value;
                const email = form.querySelector('input[type="email"]').value;
                const country = form.querySelectorAll('input[type="text"]').value;
                const area = form.querySelector('select').value;
                const proposal = form.querySelector('textarea').value;

                await addDoc(collection(db, 'contributors'), {
                    name: name,
                    email: email,
                    country: country,
                    areaOfInterest: area,
                    proposal: proposal,
                    submittedAt: new Date().toISOString()
                });

                form.reset();
                showNotification('Proposal submitted successfully!', 'success');
            } catch (error) {
                console.error('Error submitting contributor form:', error);
                showNotification('Error submitting proposal', 'error');
            }
        };

        window.selectPlan = function(plan) {
            localStorage.setItem('selectedPlan', plan);
            const planNames = { free: 'Free', researcher: 'Researcher', institutional: 'Institutional' };
            showNotification(`Welcome to the ${planNames[plan]} plan!`, 'success');
        };

        // ========================================
        // ADMIN PANEL
        // ========================================
        window.toggleAdminLogin = function() {
            document.getElementById('adminLoginModal').classList.add('active');
        };

        window.closeAdminLogin = function() {
            document.getElementById('adminLoginModal').classList.remove('active');
        };

        window.handleAdminLogin = async function(event) {
            event.preventDefault();
            try {
                const email = document.getElementById('adminEmail').value;
                const password = document.getElementById('adminPassword').value;

                await signInWithEmailAndPassword(auth, email, password);
                closeAdminLogin();
                showSection('admin');
                showNotification('Admin login successful!', 'success');
                loadAdminData();
            } catch (error) {
                console.error('Admin login error:', error);
                showNotification('Invalid credentials', 'error');
            }
        };

        window.handleAdminLogout = async function() {
            try {
                await signOut(auth);
                currentUser = null;
                isAdmin = false;
                showNotification('Logged out successfully', 'success');
                showSection('home');
            } catch (error) {
                console.error('Logout error:', error);
                showNotification('Error logging out', 'error');
            }
        };

        window.switchAdminTab = function(tab) {
            document.querySelectorAll('.admin-tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.admin-content').forEach(c => c.classList.remove('active'));
            
            event.target.classList.add('active');
            document.getElementById(`admin-${tab}`).classList.add('active');
        };

        async function loadAdminData() {
            if (!isAdmin) return;

            try {
                // Load articles for admin
                const articlesQuerySnapshot = await getDocs(collection(db, 'articles'));
                const adminArticlesList = document.getElementById('adminArticlesList');
                adminArticlesList.innerHTML = '';

                articlesQuerySnapshot.forEach((doc) => {
                    const article = { id: doc.id, ...doc.data() };
                    const item = document.createElement('div');
                    item.className = 'admin-item';
                    item.innerHTML = `
                        <div class="admin-item-info">
                            <h4>${article.title}</h4>
                            <p>${article.category} - ${article.language}</p>
                        </div>
                        <div>
                            <button class="btn-sm" onclick="editArticle('${article.id}')">Edit</button>
                            <button class="btn-sm delete" onclick="deleteArticle('${article.id}')">Delete</button>
                        </div>
                    `;
                    adminArticlesList.appendChild(item);
                });

                // Load blog posts for admin
                const blogQuerySnapshot = await getDocs(collection(db, 'blogPosts'));
                const adminBlogList = document.getElementById('adminBlogList');
                adminBlogList.innerHTML = '';

                blogQuerySnapshot.forEach((doc) => {
                    const post = { id: doc.id, ...doc.data() };
                    const item = document.createElement('div');
                    item.className = 'admin-item';
                    item.innerHTML = `
                        <div class="admin-item-info">
                            <h4>${post.title}</h4>
                            <p>${post.category} - ${post.language}</p>
                        </div>
                        <div>
                            <button class="btn-sm" onclick="editBlog('${post.id}')">Edit</button>
                            <button class="btn-sm delete" onclick="deleteBlog('${post.id}')">Delete</button>
                        </div>
                    `;
                    adminBlogList.appendChild(item);
                });

                // Load form submissions
                const newsletterQuerySnapshot = await getDocs(collection(db, 'newsletterSubscribers'));
                const contactQuerySnapshot = await getDocs(collection(db, 'contactMessages'));
                const contributorsQuerySnapshot = await getDocs(collection(db, 'contributors'));

                const adminSubmissionsList = document.getElementById('adminSubmissionsList');
                adminSubmissionsList.innerHTML = `
                    <h3>Newsletter Subscribers (${newsletterQuerySnapshot.size})</h3>
                    <div class="admin-list">
                        ${Array.from(newsletterQuerySnapshot.docs).map(doc => `
                            <div class="admin-item">
                                <div class="admin-item-info">
                                    <p>${doc.data().email}</p>
                                    <p style="font-size: 11px;">${new Date(doc.data().subscribedAt).toLocaleDateString()}</p>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                    <h3 style="margin-top: 30px;">Contact Messages (${contactQuerySnapshot.size})</h3>
                    <div class="admin-list">
                        ${Array.from(contactQuerySnapshot.docs).map(doc => `
                            <div class="admin-item">
                                <div class="admin-item-info">
                                    <h4>${doc.data().name}</h4>
                                    <p>${doc.data().email} - ${doc.data().subject}</p>
                                    <p style="font-size: 12px; margin-top: 5px;">${doc.data().message.substring(0, 100)}...</p>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                    <h3 style="margin-top: 30px;">Contributor Proposals (${contributorsQuerySnapshot.size})</h3>
                    <div class="admin-list">
                        ${Array.from(contributorsQuerySnapshot.docs).map(doc => `
                            <div class="admin-item">
                                <div class="admin-item-info">
                                    <h4>${doc.data().name}</h4>
                                    <p>${doc.data().email} - ${doc.data().country}</p>
                                    <p>${doc.data().areaOfInterest}</p>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                `;
            } catch (error) {
                console.error('Error loading admin data:', error);
            }
        }

        window.openArticleForm = function() {
            document.getElementById('articleFormModal').classList.add('active');
        };

        window.closeArticleForm = function() {
            document.getElementById('articleFormModal').classList.remove('active');
            document.getElementById('articleTitle').value = '';
            document.getElementById('articleAuthor').value = '';
            document.getElementById('articleCategory').value = '';
            document.getElementById('articleExcerpt').value = '';
            document.getElementById('articleContent').value = '';
            document.getElementById('articleTags').value = '';
        };

        window.handleArticleSave = async function(event) {
            event.preventDefault();
            try {
                const title = document.getElementById('articleTitle').value;
                const author = document.getElementById('articleAuthor').value;
                const category = document.getElementById('articleCategory').value;
                const language = document.getElementById('articleLanguage').value;
                const excerpt = document.getElementById('articleExcerpt').value;
                const content = document.getElementById('articleContent').value;
                const tags = document.getElementById('articleTags').value.split(',').map(t => t.trim());

                await addDoc(collection(db, 'articles'), {
                    title,
                    author,
                    category,
                    language,
                    excerpt,
                    content,
                    tags,
                    date: new Date().toISOString(),
                    findings: []
                });

                closeArticleForm();
                showNotification('Article created successfully!', 'success');
                loadArticles();
                loadAdminData();
            } catch (error) {
                console.error('Error saving article:', error);
                showNotification('Error saving article', 'error');
            }
        };

        window.openBlogForm = function() {
            document.getElementById('blogFormModal').classList.add('active');
        };

        window.closeBlogForm = function() {
            document.getElementById('blogFormModal').classList.remove('active');
            document.getElementById('blogTitle').value = '';
            document.getElementById('blogAuthor').value = '';
            document.getElementById('blogCategory').value = '';
            document.getElementById('blogExcerpt').value = '';
            document.getElementById('blogContent').value = '';
        };

        window.handleBlogSave = async function(event) {
            event.preventDefault();
            try {
                const title = document.getElementById('blogTitle').value;
                const author = document.getElementById('blogAuthor').value;
                const category = document.getElementById('blogCategory').value;
                const language = document.getElementById('blogLanguage').value;
                const excerpt = document.getElementById('blogExcerpt').value;
                const content = document.getElementById('blogContent').value;

                await addDoc(collection(db, 'blogPosts'), {
                    title,
                    author,
                    category,
                    language,
                    excerpt,
                    content,
                    date: new Date().toISOString()
                });

                closeBlogForm();
                showNotification('Blog post created successfully!', 'success');
                loadBlogPosts();
                loadAdminData();
            } catch (error) {
                console.error('Error saving blog post:', error);
                showNotification('Error saving blog post', 'error');
            }
        };

        window.deleteArticle = async function(articleId) {
            if (confirm('Are you sure you want to delete this article?')) {
                try {
                    await deleteDoc(doc(db, 'articles', articleId));
                    showNotification('Article deleted successfully!', 'success');
                    loadArticles();
                    loadAdminData();
                } catch (error) {
                    console.error('Error deleting article:', error);
                    showNotification('Error deleting article', 'error');
                }
            }
        };

        window.deleteBlog = async function(blogId) {
            if (confirm('Are you sure you want to delete this blog post?')) {
                try {
                    await deleteDoc(doc(db, 'blogPosts', blogId));
                    showNotification('Blog post deleted successfully!', 'success');
                    loadBlogPosts();
                    loadAdminData();
                } catch (error) {
                    console.error('Error deleting blog post:', error);
                    showNotification('Error deleting blog post', 'error');
                }
            }
        };

        // ========================================
        // EXPORT GLOBAL FUNCTIONS
        // ========================================
        window.t = t;
        window.toggleMenu = toggleMenu;
        window.closeMenu = closeMenu;
        window.showNotification = showNotification;
        window.changeLanguage = changeLanguage;
        window.filterArticles = filterArticles;
        window.filterTopics = filterTopics;

        // ========================================
        // START APP
        // ========================================
        document.addEventListener('DOMContentLoaded', initApp);
    </script>
</body>
</html>
```

---

## 📋 INSTRUCCIONES DE CONFIGURACIÓN

### 1. **Crear Proyecto en Firebase**

1. Ve a https://console.firebase.google.com
2. Crea nuevo proyecto
3. Activa Firestore Database y Authentication
4. En Authentication: habilita Email/Password

### 2. **Copiar tu Firebase Config**

1. En Firebase Console → Project Settings
2. Copia tu `firebaseConfig`
3. Reemplaza en el HTML (línea ~630) los valores de:
   - `apiKey`
   - `authDomain`
   - `projectId`
   - `storageBucket`
   - `messagingSenderId`
   - `appId`

### 3. **Crear Colecciones en Firestore**

Crea estas colecciones en Firestore:
- **articles** (documents con: title, author, category, language, excerpt, content, tags, date, findings)
- **blogPosts** (title, author, category, language, excerpt, content, date)
- **topics** (title, category, starter, excerpt, date, likes, replyCount)
- **replies** (topicId, author, content, date, likes)
- **newsletterSubscribers** (email, subscribedAt)
- **contactMessages** (name, email, subject, message, submittedAt)
- **contributors** (name, email, country, areaOfInterest, proposal, submittedAt)
- **library** (title, type, topic, year)

### 4. **Reglas de Seguridad (Security Rules)**

En Firestore → Rules, reemplaza con:

rules_version = '2'; service cloud.firestore { match /databases/{database}/documents { // Public read for collections match /{document=**} { allow read: if true; }

text
// Admin only write (authenticated users with admin role)
match /articles/{document=**} {
  allow write: if request.auth != null;
}
match /blogPosts/{document=**} {
  allow write: if request.auth != null;
}
match /topics/{document=**} {
  allow write: if true;
}
match /replies/{document=**} {
  allow write: if true;
}
match /newsletterSubscribers/{document=**} {
  allow write: if true;
}
match /contactMessages/{document=**} {
  allow write: if true;
}
match /contributors/{document=**} {
  allow write: if true;
}
match /library/{document=**} {
  allow write: if request.auth != null;
}
